<div class="auth-container">
  <div class="form-wrapper">
    
    <!-- HEADER SECTION -->
    <div class="header-section" *ngIf="!isRegistering">
      <h1 class="page-title">Welcome Back</h1>
      <p class="page-subtitle">Sign in to your CampusSync account</p>
    </div>

    <div class="header-section" *ngIf="isRegistering">
      <h1 class="page-title">Create Account</h1>
      <p class="page-subtitle">Join your campus community</p>
    </div>

    <!-- LOGIN FORM -->
    <mat-card class="auth-form-card" *ngIf="!isRegistering">
      <mat-card-content>
        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="auth-form">

          <!-- Email Field -->
          <div class="form-field-wrapper">
            <label for="login-email" class="form-field-label">Email Address</label>
            <mat-form-field appearance="outline" class="full-width">
              <input 
                matInput 
                id="login-email"
                type="email" 
                formControlName="email" 
                placeholder="your.email@example.com"
                autocomplete="email"
              />
              <mat-error *ngIf="loginForm.get('email')?.hasError('required')">
                Email is required
              </mat-error>
              <mat-error *ngIf="loginForm.get('email')?.hasError('email')">
                Please enter a valid email
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Password Field -->
          <div class="form-field-wrapper">
            <label for="login-password" class="form-field-label">Password</label>
            <mat-form-field appearance="outline" class="full-width">
              <input 
                matInput 
                id="login-password"
                [type]="hidePassword ? 'password' : 'text'" 
                formControlName="password" 
                placeholder="Enter your password"
                autocomplete="current-password"
              />
              <button 
                mat-icon-button 
                matSuffix 
                type="button"
                (click)="togglePasswordVisibility()"
                [attr.aria-label]="hidePassword ? 'Show password' : 'Hide password'"
                class="password-toggle"
              >
                <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
              <mat-error *ngIf="loginForm.get('password')?.hasError('required')">
                Password is required
              </mat-error>
              <mat-error *ngIf="loginForm.get('password')?.hasError('minlength')">
                Password must be at least 6 characters
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Error Alert -->
          <div *ngIf="errorMessage" class="error-alert">
            <mat-icon>error_outline</mat-icon>
            <span>{{ errorMessage }}</span>
          </div>

          <!-- Submit Button -->
          <div class="actions-section">
            <button 
              mat-raised-button 
              color="primary" 
              type="submit" 
              class="submit-btn"
              [disabled]="loginForm.invalid || isLoading"
            >
              <span *ngIf="!isLoading">SIGN IN</span>
              <span *ngIf="isLoading">SIGNING IN...</span>
            </button>
          </div>

        </form>

        <!-- Toggle Link -->
        <div class="toggle-section">
          <p>New here? <a (click)="toggleRegistration()" class="toggle-link">Create an account</a></p>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- SIGNUP FORM -->
    <mat-card class="auth-form-card" *ngIf="isRegistering">
      <mat-card-content>
        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="auth-form">

          <!-- Personal Info Section -->
          <div class="form-section">
            <label class="section-label">Personal Information</label>

            <!-- First and Last Name Row -->
            <div class="form-row">
              <div class="form-field-wrapper">
                <label for="firstName" class="form-field-label">First Name</label>
                <mat-form-field appearance="outline">
                  <input 
                    matInput 
                    id="firstName"
                    formControlName="firstName" 
                    placeholder="John"
                  />
                  <mat-error *ngIf="registerForm.get('firstName')?.hasError('required')">
                    First name is required
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="form-field-wrapper">
                <label for="lastName" class="form-field-label">Last Name</label>
                <mat-form-field appearance="outline">
                  <input 
                    matInput 
                    id="lastName"
                    formControlName="lastName" 
                    placeholder="Doe"
                  />
                  <mat-error *ngIf="registerForm.get('lastName')?.hasError('required')">
                    Last name is required
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <!-- Email -->
            <div class="form-field-wrapper">
              <label for="signup-email" class="form-field-label">Email Address</label>
              <mat-form-field appearance="outline" class="full-width">
                <input 
                  matInput 
                  id="signup-email"
                  type="email" 
                  formControlName="email" 
                  placeholder="your.email@example.com"
                  autocomplete="email"
                />
                <mat-error *ngIf="registerForm.get('email')?.hasError('required')">
                  Email is required
                </mat-error>
                <mat-error *ngIf="registerForm.get('email')?.hasError('email')">
                  Please enter a valid email
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Phone Number -->
            <div class="form-field-wrapper">
              <label for="phoneNumber" class="form-field-label">Phone Number</label>
              <mat-form-field appearance="outline" class="full-width">
                <input 
                  matInput 
                  id="phoneNumber"
                  formControlName="phoneNumber" 
                  placeholder="+91 98765 43210"
                />
                <mat-error *ngIf="registerForm.get('phoneNumber')?.hasError('required')">
                  Phone number is required
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <!-- Academic Info Section -->
          <div class="form-section">
            <label class="section-label">Academic Information</label>

            <!-- Student ID -->
            <div class="form-field-wrapper">
              <label for="studentId" class="form-field-label">USN / Student ID</label>
              <mat-form-field appearance="outline" class="full-width">
                <input 
                  matInput 
                  id="studentId"
                  formControlName="studentId" 
                  placeholder="e.g., USN12345"
                />
                <mat-error *ngIf="registerForm.get('studentId')?.hasError('required')">
                  Student ID is required
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Branch and Semester Row -->
            <div class="form-row">
              <div class="form-field-wrapper">
                <label for="branch" class="form-field-label">Branch</label>
                <mat-form-field appearance="outline">
                  <input 
                    matInput 
                    id="branch"
                    formControlName="branch" 
                    placeholder="CSE, ECE, etc."
                  />
                  <mat-error *ngIf="registerForm.get('branch')?.hasError('required')">
                    Branch is required
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="form-field-wrapper">
                <label for="semester" class="form-field-label">Semester</label>
                <mat-form-field appearance="outline">
                  <mat-select id="semester" formControlName="semester">
                    <mat-option *ngFor="let sem of semesters" [value]="sem">
                      {{ sem }}
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="registerForm.get('semester')?.hasError('required')">
                    Semester is required
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>

          <!-- Account Security Section -->
          <div class="form-section">
            <label class="section-label">Account Security</label>

            <!-- Password -->
            <div class="form-field-wrapper">
              <label for="signup-password" class="form-field-label">Password</label>
              <mat-form-field appearance="outline" class="full-width">
                <input 
                  matInput 
                  id="signup-password"
                  [type]="hidePassword ? 'password' : 'text'" 
                  formControlName="password" 
                  placeholder="Create a strong password"
                  autocomplete="new-password"
                />
                <button 
                  mat-icon-button 
                  matSuffix 
                  type="button"
                  (click)="togglePasswordVisibility()"
                  [attr.aria-label]="hidePassword ? 'Show password' : 'Hide password'"
                  class="password-toggle"
                >
                  <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                </button>
                <mat-error *ngIf="registerForm.get('password')?.hasError('required')">
                  Password is required
                </mat-error>
                <mat-error *ngIf="registerForm.get('password')?.hasError('minlength')">
                  Password must be at least 6 characters
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <!-- Error Alert -->
          <div *ngIf="errorMessage" class="error-alert">
            <mat-icon>error_outline</mat-icon>
            <span>{{ errorMessage }}</span>
          </div>

          <!-- Submit Button -->
          <div class="actions-section">
            <button 
              mat-raised-button 
              color="primary" 
              type="submit" 
              class="submit-btn"
              [disabled]="registerForm.invalid || isLoading"
            >
              <span *ngIf="!isLoading">CREATE ACCOUNT</span>
              <span *ngIf="isLoading">CREATING...</span>
            </button>
          </div>

        </form>

        <!-- Toggle Link -->
        <div class="toggle-section">
          <p>Already a member? <a (click)="toggleRegistration()" class="toggle-link">Sign in</a></p>
        </div>
      </mat-card-content>
    </mat-card>

  </div>
</div>
